<img src="docs/cajus-nvim.png" width="128" align="right">

# cajus-nfnl
A curvy and juicy neovim configuration following the "Keep it simple!" design principle, but using [nfnl](https://github.com/Olical/nfnl) instead of [aniseed](https://github.com/Olical/aniseed).

Fork from [cajus-nvim](https://github.com/rafaeldelboni/cajus-nvim)

## What is this?
Setup config to transform your NVIM in a powerful Clojure IDE using fennel, clojure-lsp and conjure.  
This is simplified version on my personal [dotfiles](https://github.com/rafaeldelboni/dotfiles) setup, I highly recommend you to check it out for more advanced and updated configurations.

## Prerequisites
Things you need installed in your OS to use this setup
- [git](https://git-scm.com/downloads)
- [nvim](https://neovim.io/)
- [rg](https://github.com/BurntSushi/ripgrep)
- [clojure-lsp](https://github.com/clojure-lsp/clojure-lsp)
- [nerd-fonts](https://www.nerdfonts.com/)

## How to use

**Make sure you backup your current configuration files in `$HOME/.config/nvim` BEFORE running this.**

Run these commands in the root of this repo:
```bash
# Delete the current nvim config
rm -rf $HOME/.config/nvim

# Makes a symbolic link to the files in this repo
ln -sf $PWD/.config/nvim $HOME/.config/nvim
```

> The first time you open a Fennel file under this directory you'll be prompted to trust this configuration file since it's Fennel code that's executed on your behalf. You can put any Fennel code you want in this file, just be sure to return a table of configuration at the end.

## Plugins
 - [lazy](https://github.com/folke/lazy.nvim) *A modern plugin manager for Neovim*
 - [nfnl](https://github.com/Olical/nfnl) *Enhance your Neovim with Fennel*
 - [conjure](https://github.com/Olical/conjure) *Interactive repl based evaluation for nvim*
 - [telescope](https://github.com/nvim-telescope/telescope.nvim) *Find, Filter, Preview, Pick*
 - [treesitter](https://github.com/nvim-treesitter/nvim-treesitter) *Incremental parsing system for highlighting, indentation, or folding*
 - [nvim-lspconfig](https://github.com/neovim/nvim-lspconfig) *Quickstart configurations for the Nvim LSP client*
 - [nvim-cmp](https://github.com/hrsh7th/nvim-cmp) *Autocompletion plugin*
 - [tokyonight-nvim](https://github.com/folke/tokyonight.nvim) *A clean, dark Neovim theme written in Lua*
 - [nvim-paredit](https://github.com/julienvincent/nvim-paredit) *A Paredit implementation for Neovim, built using Treesitter and written in Lua.*
 - [nvim-paredit-fennel](https://github.com/julienvincent/nvim-paredit-fennel) *A fennel language extension for nvim-paredit*
 - [nvim-surround](https://github.com/kylechui/nvim-surround) * Add/change/delete surrounding delimiter pairs with ease. Written with ❤️ in Lua.*
 - [nvim-autopairs](https://github.com/windwp/nvim-autopairs) *autopairs for neovim written by lua*
 - [lualine](https://github.com/nvim-lualine/lualine.nvim) *neovim statusline plugin written in pure lua*
 - [luasnip](https://github.com/L3MON4D3/LuaSnip) *Snippet Engine for Neovim written in Lua.*

## Files
All `*.lua` files, apart from `.config/nvim/init.lua` and `.config/nvim/lua/plugins.lua`, are generated by nfnl and should not be edited directly.

### [.config/nvim/init.lua](.config/nvim/init.lua)
Bootstrapper is written in Lua with recommended setup for lazy.nvim.
> This file also contains settings for the leader key as `space` and local-leader as `,`, unfortunately, this has to be done only here before lazy.nvim setup due to its limitations.

### [.config/nvim/lua/plugins.lua](.config/nvim/lua/plugins.lua)
The last lua file manually created for this setup, defines some required plugins (nfnl & nvim.lua) that are needed for the fennel setup works and the lazy.nvim as an updatable plugin.

### [.config/nvim/fnl/plugins/theme.fnl](.config/nvim/fnl/plugins/theme.fnl)
Theme settings like style and comment style.

### [.config/nvim/fnl/plugins/lualine.fnl](.config/nvim/fnl/plugins/lualine.fnl)
Settings for lualine status line like some theme overrides and setting what will be shown in the line.
Also calls some lsp functions to read the startup state on the status line.

### [.config/nvim/fnl/plugins/lsp.fnl](.config/nvim/fnl/plugins/lsp.fnl)
All about nvim's lsp settings and keymaps.

#### Settings:

- In the first session, we define which symbols to show for lsp diagnostics.
- Later we describe which features and server settings we want to enable/customize.
  - Handler defines features and how we want to render the server outputs.
  - Capabilities we link with our autocompletion plugin (nvim-cmp), to say to the lsp servers that we have this feature enabled.
  - On_Attach we customize our interaction with the LSP server, here we define the following keymaps:
    - `gd` Go to definition
    - `K` Show documentation
    - `<leader>ld` Function declarations
    - `<leader>lt` Type Definitions
    - `<leader>lh` Signature Help
    - `<leader>ln` Rename
    - `<leader>le` Show line diagnostics
    - `<leader>lq` Show all diagnostics information
    - `<leader>lf` Auto format
    - `<leader>lj` Go to the next diagnostic
    - `<leader>lk` Go to the previous diagnostic
    - `<leader>la` Open code actions menu (Using telescope plugin interface)
    - `<leader>la` Open code actions menu for the selected text in **VISUAL mode** (Using telescope plugin interface)
    - `<leader>lw` Open workspace diagnostics list (Using telescope plugin interface)
    - `<leader>lr` Show all references list for an item under the cursor (Using telescope plugin interface)
    - `<leader>lr` Show all implementations list for an item under the cursor (Using telescope plugin interface)
- Lastly, we configure to use all settings above in clojure-lsp server instance.

### [.config/nvim/fnl/plugins/paredit.fnl](.config/nvim/fnl/plugins/paredit.fnl)
Config for a bundle of plugins to have a modern "vim-sexp-mappings-for-regular-people" like experience for lisp languages like Clojure and Fennel.

Adds simpler mappings for slurpage and barfage using `<localleader>a|A|d|D`, so that `<localleader>a` and `<localleader>d` move the current form closure backwards or forwards and `<localleader>A` and `<localleader>D` revert these same movements (in vim fashion).

### [.config/nvim/fnl/plugins/telescope.fnl](.config/nvim/fnl/plugins/telescope.fnl)
Settings like ignore `node_modules` and everything in `.gitignore` to be listed in the file finder.
Keymaps:
 - `<leader>ff` open the find files
 - `<leader>fg` open the fuzzy finder
 - `<leader>fb` open the find open buffer
 - `<leader>fh` open the nvim help fuzzy finder

### [.config/nvim/fnl/plugins/conjure.fnl](.config/nvim/fnl/plugins/conjure.fnl)
Conjure specifics settings, I like to remap the doc work keymap to be `<localleader>K` instead of `K`, to not conflict with the LSP docs `K`.

### [.config/nvim/fnl/plugins/treesitter.fnl](.config/nvim/fnl/plugins/treesitter.fnl)
Settings to select which treesitter's features we want to be enabled and which language extension we want to ensure they will be always installed.

### [.config/nvim/fnl/plugins/cmp.fnl](.config/nvim/fnl/plugins/cmp.fnl)
Here settings of which sources we want to show up in the autocomple menu like (conjure, lsp, buffer) and some mapping to navigate in the menu.

### [.config/nvim/fnl/config/lsp.fnl](.config/nvim/fnl/config/lsp.fnl)
Setup a global state to define lsp's startup status, for later be read by lualine.

### [.config/nvim/fnl/config/init.fnl](.config/nvim/fnl/config/init.fnl)
Set basic global vim configurations and general keymaps.

### [.config/nvim/.nfnl.fnl](.config/nvim/.nfnl.fnl)
nfnl's configuration file at the root of the project, is blank to rely on the defaults.

## Features
Some gifs showing how it works.

### Telescope - Find Files
![telescope-find-files](docs/telescope-find-files.gif)
**`<leader>ff`**

### Lsp - Loading
![lsp-loading](docs/lsp-loading.gif)
**`on startup`**

### Lsp - Syntax check
![lsp-syntax-check](docs/lsp-syntax-check.gif)
**`<leader>le`**

### Lsp - Go to definition
![lsp-go-to-definition](docs/lsp-go-to-definition.gif)
**`gd`**

### Lsp - Document/Signature Help
![lsp-document](docs/lsp-document.gif)
**`K`/`<leader>lh`**

### Lsp - Find definition/references
![lsp-find-references](docs/lsp-find-references.gif)
**`<leader>lr`**

### Lsp - Formatting
![lsp-format](docs/lsp-format.gif)
**`<leader>lf`**

### Lsp - Code actions
![lsp-code-actions](docs/lsp-code-actions.gif)
**`<leader>la`**

### Lsp - Refactorings
![lsp-refactorings](docs/lsp-refactorings.gif)
**`<leader>la`**

### Lsp - Rename
![lsp-rename](docs/lsp-rename.gif)
**`<leader>ln`**

### Conjure - Eval
![conjure-eval](docs/conjure-eval.gif)
**`<localleader>er`**

### Conjure - Repl
![conjure-repl](docs/conjure-repl.gif)
**`<localleader>lv`**

### Conjure - Document
![conjure-document](docs/conjure-document.gif)
**`<localleader>K`**

### Completion
![auto-complete](docs/auto-complete.gif)

## Etymology
Cajus is the Portuguese for cashews, which is a fitting name because the format of its nuts reminded me of a parenthesis.

## Contributing
If you find any dead links, misinformation or any improvements in this documents at all [Emails](https://github.com/rafaeldelboni), [PRs](https://github.com/rafaeldelboni/cajus-nvim/pulls) and [Issues](https://github.com/rafaeldelboni/cajus-nvim/issues) are highly encouraged.

## License
This is free and unencumbered software released into the public domain.
For more information, please refer to <http://unlicense.org>
